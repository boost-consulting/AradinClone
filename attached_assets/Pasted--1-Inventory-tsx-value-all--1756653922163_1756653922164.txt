優先度1（ブロッカーの解消）

在庫一覧のセレクトエラーを解消する

Inventory.tsx のフィルタ用セレクトは、空文字の value を使用しない。

「すべて」は "all" のような非空の定数で表現し、コンポーネントの初期値も "all" に合わせる。

locations / states の各 SelectItem も 必ず非空の value を割り当てる。

セレクトの現在値が undefined / "" にならないよう、初期化する。

空データでも画面が壊れないようにする

全ページの表・カード・リストに空状態の表示（例：「該当データがありません」）を入れておく。

KPI 数値は 0 を安全表示できるようにする（null/undefined で NaN にしない）。

優先度2（最小運用の成立：ダミーデータ＋集計）

ダミーデータを投入できる仕組みを用意する

どちらかの方法でよい：
A. 起動時シード：DB が空の場合のみ、サーバ側で初期データを投入。
B. UIからのシード：マスタ管理ページの上部に「サンプルデータ作成」ボタンを設け、API（例：POST /api/seed）で投入。

シードに含める内容（最小・実運用っぽく見える量）：

商品：12型 × 色2 × サイズ3 ＝ 72SKU（例：SHIRT01..06、PANTS01..03、JACKET01..03 × BK/IV × S/M/L）。

場所：倉庫（棚A/B/C）＋ 店舗1〜6。

補充基準（SKU×場所）：店舗= 下限2 / 基準5 / 標準補充量5、倉庫= 下限5 / 基準15 / 標準補充量20。

在庫残高（SKU×場所×状態）：倉庫は SKUごとに合計20（A=10/B=6/C=4、主に「通常」）、店舗は 0〜5（主に「通常」、ごく少量の「不良」）。

出荷指示：店舗1に3件、店舗2に2件（状態=受付中）。

履歴：受入→棚入れ2件、販売3件、顧客返品1件、店舗→倉庫返品送付1件、返品受入＋返品検品1件、在庫確保1件。

目的：ダッシュボード、在庫一覧、入出庫、販売管理、出荷指示、返品管理のすべてに“それらしい数字と行”が表示される状態にする。

ダッシュボード／在庫一覧の集計を期待仕様どおりに出す

ダッシュボード：

上段4カード＝未処理の出荷指示件数／本日の仕入受入（予定・処理済）／下限割れSKU件数／直近7日の販売点数。

下段＝未処理の出荷指示一覧、少数アラート詳細。

在庫一覧：SKU×場所 の行で「通常／確保／検品中／不良／合計」を表示。

フィルタ：SKUテキスト検索、場所セレクト、状態セレクト、「下限割れのみ」トグル。

初期状態は 場所=all・状態=all とし、初回表示で必ず一覧が出る。

優先度3（操作の一貫性：保存→反映）

保存後は必ず “保存→関連ページへ移動→最新読み直し”

出荷指示作成：作成後は出荷指示ページへ戻し、未処理リストが増えていることを確認できるようにする。

出荷確定・確保・受入・棚入れ・販売・顧客返品・店舗→倉庫返品送付・返品検品：それぞれ当該ページへ戻す。

成功／失敗はトースト通知で即時フィードバック。

履歴サイドバーを常時機能させる

HistorySidebar.tsx のデータ取得は /api/history?limit=20 を呼ぶようにする（現在は /api/history/20 になっているため、サーバのルートと不一致）。

各ページ右サイドで「直近の履歴（20件）」を表示し、ページのテーマに応じて自動フィルタ（入出庫：受入/棚入れ/確保/出荷、販売管理：販売/顧客返品、等）。

優先度4（使い勝手の底上げ）

出荷指示の“推奨数量”を自動セット

数量の初期値＝基準在庫 − 現在庫（通常）（負数は0）。

ダッシュボードや出荷指示の少数アラート行をクリックすると、SKUと推奨数量がフォームに入る。

ヘッダーの通知バッジを実データに接続

固定の「7」ではなく、未処理の出荷指示件数を表示する。

クリック時の導線は出荷指示ページまたは**入出庫ページ（出荷処理タブ）**へ。

用語の統一（履歴種別）

サーバの履歴種別とUIの表示を一致させる。特に**「棚入れ」と「棚入れ確定」**の表記揺れを解消し、色分けロジックも該当文字列に合わせる。

店舗選択の一貫性

ヘッダーの店舗セレクタの選択を、販売管理／出荷指示／返品管理の初期値に反映。

店舗ロール運用時はセレクタを固定し、誤った店舗での登録を防ぐ。

優先度5（データ整合の取り決め）

在庫更新は一体処理＋履歴追記で統一

1操作＝在庫残の更新 → 履歴1行の追記を原子化。

代表ケース：

出荷確定：倉庫（通常 or 確保）を減算 → 店舗（通常）を加算 → 出荷指示を完了。

受入→棚入れ：倉庫の検品中に加算 → 確定で良品は通常へ、不良は不良へ。

顧客返品（店舗）：再販可は店舗の通常へ、不良は店舗の不良へ。

店舗→倉庫返品送付：店舗の通常を減算 → 倉庫側に到着登録（検品中へ）。

確保：倉庫の通常を減算し、確保に加算。

受け入れ確認の流れ（最終チェック）

出荷指示を作成 → ダッシュボードと入出庫の未処理一覧に即反映。

入出庫で出荷を確定 → 倉庫在庫↓・店舗在庫↑・指示は完了。

販売を登録 → 店舗の通常↓・販売履歴に金額。

顧客返品（再販可）を登録 → 店舗の通常↑（不良選択時は店舗の不良↑）。

店舗→倉庫返品送付 → 入出庫の「返品受入・検品」に到着し、検品確定で倉庫の通常 or 不良へ。

仕入受入→棚入れ確定 → 倉庫の検品中→通常/不良に反映。

在庫一覧で SKU×場所の 通常／確保／検品中／不良／合計 が期待どおりに更新される。